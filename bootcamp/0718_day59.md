## 0718_Day59

리액트 스탠다드 17일차 강의 내용 정리

## 1. Loading UI와 Streaming

- (포켓몬 과제) 홈 화면에서 카드를 클릭했을 때 상세 페이지로 이동하는 데까지 blocking 현상이 있는 이유

  - 상세 페이지는 **SSR 페이지**이고, **`await` API 통신 실행이 완료될 때까지 blocking**된 후 return 문을 실행한 이후 상세 페이지로 Client Side Navigation하기 때문이다.

- `loading.tsx`

  - 특수 파일인 `loading.tsx` 파일을 사용하면 React Suspense로 의미 있는 로딩 UI를 만들 수 있다.

    ```tsx
    // app/loading.tsx

    export default function Loading() {
      return <LoadingSkeleton />;
    }
    ```

  - `layout.tsx` 파일 및 그 하위 경로의 `page.tsx` 파일이 렌더링되는 동안 로딩 상태를 표시한다.

    ![alt text](https://teamsparta.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F83c75a39-3aba-4ba4-a792-7aefe4b07895%2Fd336dfb2-2ff7-42ad-b552-f49fa587a5d2%2FUntitled.png?table=block&id=f0cda310-22b6-46e5-b3a1-3a9d766ea74c&spaceId=83c75a39-3aba-4ba4-a792-7aefe4b07895&width=250&userId=&cache=v2)

  - `Suspense` 컴포넌트를 이용하여 로딩 UI를 구현한 예제

    ```typescript
    // app/layout.tsx

    import type { Metadata } from "next";
    import { Inter } from "next/font/google";
    import "./globals.css";
    import QueryProvider from "@/components/QueryProvider";
    import { Suspense } from "react";

    const inter = Inter({ subsets: ["latin"] });

    export const metadata: Metadata = {
      title: "포켓몬 도감",
      description: "이것은 포켓몬 도감입니다.",
    };

    export default function RootLayout({
      children,
    }: Readonly<{ children: React.ReactNode }>) {
      return (
        <html lang="en">
          <body className={inter.className}>
            <header className="text-2xl text-center mt-4 mb-4">
              포켓몬 도감
            </header>
            <QueryProvider>
              <Suspense fallback={<div>loading.tsx 컴포넌트</div>}>
                {children}
              </Suspense>
            </QueryProvider>
          </body>
        </html>
      );
    }
    ```

    - `Suspense` 컴포넌트

      - **자식 요소가 로드되기 전까지 화면에 대체 UI를 보여주는 역할**을 한다.

      - **비동기 작업을 처리할 때 사용**할 수 있는 컴포넌트로, **로딩 상태를 관리**한다.

      - `fallback`

        - **실제 UI가 로드되기 전까지 대신 렌더링 되는 대체 UI**이다.

        - **비동기 작업이 완료되기 전까지 보여줄 컴포넌트**를 정의한다.

        - Next.js는 이 부분을 `loading.tsx`로 인식한다.

      - `Suspense` 컴포넌트는 `children`의 렌더링이 지연되면 자동으로 `fallback`으로 전환하고, 데이터가 준비되면 `children`으로 다시 전환한다.

- **Streaming**

  - **서버가 클라이언트(브라우저)에게 웹 페이지의 내용을** 한 번에 전부 보내는 대신, **부분적으로(점진적으로) 보내는 방식**이다.

  - 이는 페이지가 로딩되는 동안 **일부 콘텐츠가 준비되면 그 부분부터 먼저 사용자에게 보여주기 시작**하는 것을 의미한다.

  - `page.tsx`(SSR 페이지) 내에서 **Suspense로 Streaming을 적용**하면 **SEO와 UX를 모두 향상**시킬 수 있다.

    ```tsx
    export default async function SSRPage() {
      await fetch("서버URL"); // 이 부분은 loading.tsx에서 처리함
      return (
        <>
          <Suspense fallback={<div>로딩중...</div>}>
            <SSRComponent1 />
          </Suspense>
          <Suspense fallback={<div>로딩중...</div>}>
            <SSRComponent2 />
          </Suspense>
        </>
      );
    }
    ```

## 2. Next.js 미들웨어

## 3. 회원가입, 로그인 UI

## 4. Todo List (Read & Update) DB 스키마

## 5. Supabase Server Client 설정

## 6. Supabase SignUp Trigger

## 7. Supabase with Typescript

## 8. Supabase Login by Server Client
